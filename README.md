# ClarityFlow

<div align="center">

**Production-grade task clarification system for white-collar workers**

[![Node Version](https://img.shields.io/badge/node-%3E%3D20.0.0-brightgreen)](https://nodejs.org)
[![TypeScript](https://img.shields.io/badge/TypeScript-5.7-blue)](https://www.typescriptlang.org)
[![License](https://img.shields.io/badge/license-MIT-blue.svg)](LICENSE)

</div>

## ğŸ“– ç®€ä»‹

ClarityFlow æ˜¯ä¸€æ¬¾ä»»åŠ¡æ¾„æ¸…ç³»ç»Ÿï¼Œå¸®åŠ©å›¢é˜Ÿåœ¨æ‰§è¡Œä»»åŠ¡å‰æ˜ç¡®ç›®æ ‡ã€å®šä¹‰æˆåŠŸæ ‡å‡†ã€è¯†åˆ«é£é™©ã€‚é€šè¿‡æ ‡å‡†åŒ–çš„å·¥ä½œæµï¼ˆæ¾„æ¸… â†’ ç¡®è®¤ â†’ æ‰§è¡Œ â†’ å®Œæˆï¼‰ï¼Œå‡å°‘æ²Ÿé€šæˆæœ¬ï¼Œæé«˜äº¤ä»˜è´¨é‡ã€‚

### ğŸ¯ æ ¸å¿ƒä»·å€¼

- **ä»»åŠ¡æ¾„æ¸…** - åœ¨åŠ¨æ‰‹å‰æ˜ç¡®"åšä»€ä¹ˆ"å’Œ"ä¸ºä»€ä¹ˆ"
- **æˆåŠŸæ ‡å‡†** - ç”¨ Definition of Done (DoD) é‡åŒ–å®Œæˆæ ‡å‡†
- **é£é™©è¯†åˆ«** - æå‰é¢„åˆ¤å¯èƒ½å½±å“äº¤ä»˜çš„å› ç´ 
- **èŒƒå›´è¾¹ç•Œ** - æ˜ç¡®å“ªäº›å†…å®¹ä¸åœ¨æœ¬æ¬¡ä»»åŠ¡èŒƒå›´å†…ï¼Œé˜²æ­¢èŒƒå›´è”“å»¶

## âœ¨ åŠŸèƒ½ç‰¹æ€§

### ğŸ“‹ çœ‹æ¿å¼ä»»åŠ¡ç®¡ç†
- **å››é˜¶æ®µå·¥ä½œæµ**ï¼šå¾…æ¾„æ¸… â†’ å·²ç¡®è®¤ â†’ è¿›è¡Œä¸­ â†’ å·²å®Œæˆ
- **æ‹–æ‹½å‹å¥½**ï¼šç±»ä¼¼ Trello çš„çœ‹æ¿å¸ƒå±€ï¼ˆç§»åŠ¨ç«¯æ”¯æŒæ¨ªå‘æ»šåŠ¨ï¼‰
- **çŠ¶æ€å¯è§†åŒ–**ï¼šé¢œè‰²ç¼–ç çš„çŠ¶æ€æ ‡ç­¾å’Œå¡ç‰‡è¾¹æ¡†

### ğŸ“ ä»»åŠ¡æ–‡æ¡£åŒ–
- **ç»“æ„åŒ–å­—æ®µ**ï¼š
  - èƒŒæ™¯ä¸é—®é¢˜ (Problem)
  - æˆåŠŸæ ‡å‡† (Definition of Done)
  - è¾¹ç•Œ (Out of Scope)
  - å…³é”®äºº (Stakeholders)
  - é£é™© (Risks)
  - æˆªæ­¢æ—¥æœŸ (Due Date)
- **å¿…å¡«å­—æ®µä¿æŠ¤**ï¼šæµè½¬åˆ°å·²ç¡®è®¤çŠ¶æ€æ—¶ï¼Œç³»ç»Ÿä¼šå¼ºåˆ¶æ£€æŸ¥æ ¸å¿ƒå­—æ®µå®Œæ•´æ€§
- **åªè¯»ä¿æŠ¤**ï¼šå·²å®Œæˆçš„ä»»åŠ¡è‡ªåŠ¨é”å®šå­—æ®µ

### ğŸ”„ çŠ¶æ€æµè½¬
- **å•å‘æµè½¬**ï¼šNEEDS_CLARIFICATION â†’ CONFIRMED â†’ IN_PROGRESS â†’ DONE
- **ä¹è§‚é”**ï¼šåŸºäºç‰ˆæœ¬å·çš„å¹¶å‘æ§åˆ¶ï¼Œé˜²æ­¢è¦†ç›–å†²çª
- **å­—æ®µå®Œæ•´æ€§æ ¡éªŒ**ï¼šI5 çº¦æŸç¡®ä¿ CONFIRMED+ çŠ¶æ€çš„ä»»åŠ¡å¿…å«æ ¸å¿ƒå­—æ®µ

### ğŸ“¤ Markdown å¯¼å‡º
- ä¸€é”®å¯¼å‡ºä»»åŠ¡æ–‡æ¡£ä¸º Markdown æ ¼å¼
- åŒ…å«å®Œæ•´ä¸Šä¸‹æ–‡ã€é£é™©ã€è¾¹ç•Œä¿¡æ¯
- æ”¯æŒå¤åˆ¶åˆ°æ–‡æ¡£ç³»ç»Ÿï¼ˆNotionã€Confluence ç­‰ï¼‰

### ğŸ¨ ç°ä»£åŒ– UI
- **Modern SaaS é£æ ¼**ï¼šå‚è€ƒ Linear/Notion çš„è®¾è®¡è¯­è¨€
- **å“åº”å¼å¸ƒå±€**ï¼šå®Œç¾æ”¯æŒæ¡Œé¢å’Œç§»åŠ¨è®¾å¤‡
- **æ²‰æµ¸å¼ç¼–è¾‘**ï¼šæ–‡æ¡£é£æ ¼çš„è¯¦æƒ…é¡µï¼Œä¸“æ³¨å†…å®¹åˆ›ä½œ

## ğŸ› ï¸ æŠ€æœ¯æ ˆ

### åç«¯
- **Runtime**: Node.js 20+
- **Framework**: Express + TypeScript
- **Database**: SQLite + Prisma ORM
- **Validation**: Zod
- **Testing**: Jest

### å‰ç«¯
- **Runtime**: React 19
- **Build Tool**: Vite
- **State Management**: TanStack Query (React Query)
- **Routing**: React Router v7
- **Styling**: Tailwind CSS v3
- **UI Components**: Custom component library
- **Icons**: Lucide React

### DevOps
- **Container**: Docker + Docker Compose
- **Version Control**: Git

## ğŸ“¦ å®‰è£…ä¸è¿è¡Œ

### å‰ç½®è¦æ±‚

- **Node.js** >= 20.0.0
- **npm** >= 10.0.0
- **Git**ï¼ˆå¯é€‰ï¼Œç”¨äºå…‹éš†ä»£ç ï¼‰

### æœ¬åœ°å¼€å‘

#### 1. å…‹éš†ä»“åº“

```bash
git clone <repository-url>
cd ClarityFlow
```

#### 2. å®‰è£…ä¾èµ–

```bash
npm install
```

#### 3. åˆå§‹åŒ–æ•°æ®åº“

```bash
npx prisma migrate dev
```

#### 4. å¯åŠ¨å¼€å‘æœåŠ¡å™¨

```bash
# åŒæ—¶å¯åŠ¨ API å’Œ Web
npm run dev

# æˆ–åˆ†åˆ«å¯åŠ¨
npm run dev:api  # API æœåŠ¡è¿è¡Œåœ¨ http://localhost:3000
npm run dev:web  # Web æœåŠ¡è¿è¡Œåœ¨ http://localhost:5173
```

#### 5. è®¿é—®åº”ç”¨

æ‰“å¼€æµè§ˆå™¨è®¿é—®ï¼š**http://localhost:5173**

### Docker éƒ¨ç½²ï¼ˆæ¨èç”¨äºç”Ÿäº§ï¼‰

#### ä½¿ç”¨ Docker Composeï¼ˆæ¨èï¼‰

```bash
# æ„å»ºå¹¶å¯åŠ¨å®¹å™¨
docker-compose up -d

# æŸ¥çœ‹æ—¥å¿—
docker-compose logs -f

# åœæ­¢å®¹å™¨
docker-compose down

# é‡æ–°æ„å»ºå¹¶å¯åŠ¨
docker-compose up -d --build
```

#### ä½¿ç”¨ Docker å‘½ä»¤

```bash
# æ„å»ºé•œåƒ
docker build -t clarityflow .

# è¿è¡Œå®¹å™¨
docker run -d \
  -p 8080:3000 \
  -v ./prisma/dev.db:/app/prisma/dev.db \
  --name clarityflow \
  clarityflow

# æŸ¥çœ‹æ—¥å¿—
docker logs -f clarityflow

# åœæ­¢å¹¶åˆ é™¤å®¹å™¨
docker stop clarityflow
docker rm clarityflow
```

#### è®¿é—®ç”Ÿäº§åº”ç”¨

å¯åŠ¨åè®¿é—®ï¼š**http://localhost:8080**

## ğŸ“š ä½¿ç”¨æŒ‡å—

### åˆ›å»ºä»»åŠ¡

1. ç‚¹å‡»å³ä¸Šè§’ **"New Card"** æŒ‰é’®
2. å¡«å†™ä»»åŠ¡æ ‡é¢˜ï¼ˆå¿…å¡«ï¼‰
3. ç‚¹å‡» **"åˆ›å»º"** è¿›å…¥è¯¦æƒ…é¡µ

### ç¼–è¾‘ä»»åŠ¡æ–‡æ¡£

1. åœ¨çœ‹æ¿ä¸Šç‚¹å‡»ä»»æ„ä»»åŠ¡å¡ç‰‡
2. ç¼–è¾‘ä»¥ä¸‹å­—æ®µï¼š
   - **èƒŒæ™¯ä¸é—®é¢˜** - è¯¦ç»†è¯´æ˜ä»»åŠ¡èƒŒæ™¯å’Œå½“å‰é—®é¢˜ï¼ˆå¿…å¡«ï¼ŒçŠ¶æ€æµè½¬éœ€è¦ï¼‰
   - **æˆåŠŸæ ‡å‡†** - å®šä¹‰éªŒæ”¶æ ‡å‡†ï¼ˆå¿…å¡«ï¼ŒçŠ¶æ€æµè½¬éœ€è¦ï¼‰
   - **è¾¹ç•Œ** - æ˜ç¡®æ’é™¤çš„å†…å®¹ï¼ˆå¯é€‰ï¼‰
   - **å…³é”®äºº** - æ¶‰åŠçš„å›¢é˜Ÿæˆ–ä¸ªäººï¼ˆå¯é€‰ï¼‰
   - **é£é™©** - å¯èƒ½å½±å“äº¤ä»˜çš„å› ç´ ï¼ˆå¯é€‰ï¼‰
   - **æˆªæ­¢æ—¥æœŸ** - ä»»åŠ¡æˆªæ­¢æ—¶é—´ï¼ˆå¯é€‰ï¼‰
3. ç‚¹å‡» **"ä¿å­˜æ›´æ”¹"**

### æ¨è¿›ä»»åŠ¡çŠ¶æ€

åœ¨ä»»åŠ¡è¯¦æƒ…é¡µå³ä¸Šè§’ï¼š
- **ç¡®è®¤ä»»åŠ¡** (å¾…æ¾„æ¸… â†’ å·²ç¡®è®¤) - ç¡®ä¿æ ¸å¿ƒå­—æ®µå·²å¡«å†™
- **å¼€å§‹æ‰§è¡Œ** (å·²ç¡®è®¤ â†’ è¿›è¡Œä¸­) - æ ‡è®°ä»»åŠ¡è¿›å…¥å¼€å‘é˜¶æ®µ
- **æ ‡è®°å®Œæˆ** (è¿›è¡Œä¸­ â†’ å·²å®Œæˆ) - ä»»åŠ¡å®Œæˆåé”å®šå­—æ®µ

### å¯¼å‡ºä»»åŠ¡æ–‡æ¡£

1. æ‰“å¼€ä»»åŠ¡è¯¦æƒ…é¡µ
2. ç‚¹å‡»å³ä¸Šè§’ **"Export"** æŒ‰é’®
3. åœ¨å¼¹çª—ä¸­å¤åˆ¶ Markdown å†…å®¹
4. ç²˜è´´åˆ°æ–‡æ¡£ç³»ç»Ÿï¼ˆNotionã€Confluence ç­‰ï¼‰

## ğŸ—ï¸ é¡¹ç›®ç»“æ„

```
ClarityFlow/
â”œâ”€â”€ apps/
â”‚   â”œâ”€â”€ api/              # Express API åç«¯
â”‚   â”‚   â”œâ”€â”€ src/
â”‚   â”‚   â”‚   â”œâ”€â”€ routes/   # API è·¯ç”±
â”‚   â”‚   â”‚   â”œâ”€â”€ services/ # ä¸šåŠ¡é€»è¾‘
â”‚   â”‚   â”‚   â”œâ”€â”€ middleware/# ä¸­é—´ä»¶
â”‚   â”‚   â”‚   â””â”€â”€ app.ts    # Express åº”ç”¨
â”‚   â”‚   â””â”€â”€ prisma/       # Prisma schema
â”‚   â””â”€â”€ web/              # React å‰ç«¯
â”‚       â”œâ”€â”€ src/
â”‚       â”‚   â”œâ”€â”€ components/
â”‚       â”‚   â”‚   â””â”€â”€ ui/   # UI ç»„ä»¶åº“
â”‚       â”‚   â”œâ”€â”€ pages/    # é¡µé¢ç»„ä»¶
â”‚       â”‚   â””â”€â”€ lib/      # å·¥å…·å‡½æ•°
â”‚       â””â”€â”€ index.html
â”œâ”€â”€ prisma/
â”‚   â”œâ”€â”€ schema.prisma     # æ•°æ®åº“æ¨¡å‹
â”‚   â””â”€â”€ dev.db            # SQLite æ•°æ®åº“ï¼ˆå¼€å‘ï¼‰
â”œâ”€â”€ Dockerfile            # å¤šé˜¶æ®µ Docker é…ç½®
â”œâ”€â”€ docker-compose.yml    # Docker Compose é…ç½®
â””â”€â”€ README.md             # æœ¬æ–‡ä»¶
```

## ğŸ”§ å¼€å‘æŒ‡å—

### è¿è¡Œæµ‹è¯•

```bash
# è¿è¡Œæ‰€æœ‰æµ‹è¯•
npm test

# ä»…è¿è¡Œ API æµ‹è¯•
npm run test:api
```

### ä»£ç æ£€æŸ¥

```bash
# è¿è¡Œ ESLint
npm run lint

# è‡ªåŠ¨ä¿®å¤é—®é¢˜
npm run lint:fix
```

### æ•°æ®åº“è¿ç§»

```bash
# åˆ›å»ºè¿ç§»
npx prisma migrate dev --name <migration-name>

# é‡ç½®æ•°æ®åº“ï¼ˆå¼€å‘ç¯å¢ƒï¼‰
npx prisma migrate reset

# ç”Ÿæˆ Prisma Client
npx prisma generate
```

### æ„å»º

```bash
# æ„å»ºæ‰€æœ‰åº”ç”¨
npm run build

# ä»…æ„å»º API
npm run build -w apps/api

# ä»…æ„å»º Web
npm run build -w apps/web
```

## ğŸ›ï¸ ç³»ç»Ÿæ¶æ„

### æ•°æ®æ¨¡å‹

**Card (ä»»åŠ¡å¡ç‰‡)**
- `id`: UUIDï¼ˆä¸»é”®ï¼Œä¸å¯å˜ï¼‰
- `version`: ç‰ˆæœ¬å·ï¼ˆä¹è§‚é”ï¼‰
- `status`: çŠ¶æ€æœºï¼ˆNEEDS_CLARIFICATION | CONFIRMED | IN_PROGRESS | DONEï¼‰
- `problem`, `successCriteria`, `outOfScope`, `stakeholders`, `risks`: ä¸šåŠ¡å­—æ®µ
- `createdAt`, `updatedAt`: æ—¶é—´æˆ³
- `deletedAt`: è½¯åˆ é™¤æ ‡è®°

### ç³»ç»Ÿä¸å˜é‡ (Invariants)

1. **I1. Identity Constancy**: å¡ç‰‡ ID ä¸å¯å˜
2. **I2. Time Flow**: åˆ›å»ºæ—¶é—´ â‰¤ æ›´æ–°æ—¶é—´
3. **I3. Ghost Defense**: è½¯åˆ é™¤é¡¹é»˜è®¤ä»æ‰€æœ‰æ ‡å‡†æŸ¥è¯¢ä¸­è¿‡æ»¤
4. **I4. State Machine**: å•å‘çŠ¶æ€æµè½¬ï¼ˆä¸å¯é€†ï¼‰
5. **I5. Continuous Integrity**: CONFIRMED+ çŠ¶æ€å¿…é¡»åŒ…å«æ ¸å¿ƒå­—æ®µ
6. **I6. Export Completeness**: å¯¼å‡ºå¿…é¡»åŒ…å«ä¸Šä¸‹æ–‡ã€é£é™©ã€è¾¹ç•Œ
7. **I7. Concurrency Protection**: æ‰€æœ‰æ›´æ–°å¿…é¡»æ£€æŸ¥ç‰ˆæœ¬å·

### API ç«¯ç‚¹

| æ–¹æ³• | è·¯å¾„ | æè¿° |
|------|------|------|
| GET | `/api/cards` | è·å–æ‰€æœ‰ä»»åŠ¡ |
| GET | `/api/cards/:id` | è·å–ä»»åŠ¡è¯¦æƒ… |
| POST | `/api/cards` | åˆ›å»ºä»»åŠ¡ |
| PATCH | `/api/cards/:id` | æ›´æ–°ä»»åŠ¡ï¼ˆä¹è§‚é”ï¼‰ |
| POST | `/api/cards/:id/transition` | çŠ¶æ€æµè½¬ |
| GET | `/api/cards/:id/export` | å¯¼å‡º Markdown |
| DELETE | `/api/cards/:id` | è½¯åˆ é™¤ä»»åŠ¡ |
| GET | `/health` | å¥åº·æ£€æŸ¥ |

## ğŸ¤ è´¡çŒ®æŒ‡å—

æ¬¢è¿è´¡çŒ®ï¼è¯·éµå¾ªä»¥ä¸‹æ­¥éª¤ï¼š

1. Fork æœ¬ä»“åº“
2. åˆ›å»ºç‰¹æ€§åˆ†æ”¯ (`git checkout -b feature/AmazingFeature`)
3. æäº¤æ›´æ”¹ (`git commit -m 'Add some AmazingFeature'`)
4. æ¨é€åˆ°åˆ†æ”¯ (`git push origin feature/AmazingFeature`)
5. åˆ›å»º Pull Request

## ğŸ“„ è®¸å¯è¯

æœ¬é¡¹ç›®é‡‡ç”¨ MIT è®¸å¯è¯ã€‚è¯¦è§ [LICENSE](LICENSE) æ–‡ä»¶ã€‚

## ğŸ™ è‡´è°¢

- [Tailwind CSS](https://tailwindcss.com) - Utility-first CSS æ¡†æ¶
- [Prisma](https://www.prisma.io) - ç°ä»£åŒ– ORM
- [Vite](https://vitejs.dev) - ä¸‹ä¸€ä»£å‰ç«¯æ„å»ºå·¥å…·
- [TanStack Query](https://tanstack.com/query) - å¼ºå¤§çš„æ•°æ®åŒæ­¥åº“

---

**Built with â¤ï¸ for productive teams**
